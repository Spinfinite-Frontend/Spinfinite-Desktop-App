const{app:app,BrowserWindow:BrowserWindow,Menu:Menu,shell:shell,dialog:dialog,ipcMain:ipcMain}=require("electron"),path=require("path"),{autoUpdater:autoUpdater}=require("electron-updater"),log=require("electron-log");autoUpdater.logger=log,autoUpdater.logger.transports.file.level="info";const gotTheLock=app.requestSingleInstanceLock();let win;function createWindow(){win=new BrowserWindow({width:1024,height:768,icon:path.join(__dirname,"icon.ico"),backgroundColor:"#2B3241",frame:!1,titleBarStyle:"hidden",webPreferences:{preload:path.join(__dirname,"preload.js"),nodeIntegration:!1,contextIsolation:!0}}),win.loadURL("https://www.spinfinite.com");const e=Menu.buildFromTemplate([{label:"Help",submenu:[{label:"About",submenu:[{label:`Version: v${app.getVersion()}`,enabled:!1},{label:"Check for Updates",click:()=>{autoUpdater.checkForUpdates().then((e=>{e?.updateInfo&&e.updateInfo.version!==app.getVersion()||dialog.showMessageBox({type:"info",title:"No Update Available",message:"Youâ€™re already on the latest version.",buttons:["OK"]})})).catch((()=>{dialog.showMessageBox({type:"error",title:"Update Check Failed",message:"Could not check for updates. Please try again later.",buttons:["OK"]})}))}},{label:"Made by Anthony",enabled:!1}]},{label:"Need Help?",click:()=>shell.openExternal("https://www.spinfinite.com/help/faq/")}]}]);Menu.setApplicationMenu(e)}gotTheLock||app.quit(),autoUpdater.on("update-downloaded",(()=>{dialog.showMessageBox({type:"info",title:"Update Ready",message:"A new version has been downloaded. Restart to install now.",buttons:["Restart"]}).then((()=>{autoUpdater.quitAndInstall(!1,!0)}))})),app.whenReady().then((()=>{createWindow(),setTimeout((()=>autoUpdater.checkForUpdates()),3e3)})),app.on("second-instance",(()=>{win&&(win.isMinimized()&&win.restore(),win.focus())})),app.on("window-all-closed",(()=>{"darwin"!==process.platform&&app.quit()})),ipcMain.handle("nav-action",((e,t)=>{if(win&&!win.isDestroyed())switch(t){case"back":win.webContents.canGoBack()&&win.webContents.goBack();break;case"forward":win.webContents.canGoForward()&&win.webContents.goForward();break;case"refresh":win.webContents.reload()}})),ipcMain.handle("get-url",(()=>win?win.webContents.getURL():""));